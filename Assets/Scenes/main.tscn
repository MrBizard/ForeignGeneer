[gd_scene load_steps=16 format=3 uid="uid://dvxxm2v6se3nl"]

[ext_resource type="PackedScene" uid="uid://cbre4uav8lugb" path="res://Assets/Prefabs/Characters_rigging.tscn" id="1_6t2fw"]
[ext_resource type="Material" uid="uid://dpx2ub12p1e6i" path="res://Assets/Texture/Ingots/CopperIngot.tres" id="2_dqp1b"]
[ext_resource type="Script" path="res://Assets/Scripts/Player/Player.cs" id="2_qehyv"]
[ext_resource type="Script" path="res://VoronoiBiome/TerrainGenerator.cs" id="3_c7yye"]
[ext_resource type="Script" path="res://Assets/Scripts/Manager.cs" id="4_gc2hg"]
[ext_resource type="Script" path="res://Assets/Scripts/Player/PlayerInventory.cs" id="8_k76vs"]
[ext_resource type="Shader" path="res://Assets/Materials/Shaders/Voronoi.gdshader" id="9_54hal"]
[ext_resource type="Script" path="res://Assets/Scripts/MoveOrigin.cs" id="9_ngpnf"]

[sub_resource type="Environment" id="Environment_chybd"]

[sub_resource type="Shader" id="Shader_1mb4a"]
code = "shader_type spatial;

uniform vec3 edge_color : source_color = vec3(1.0, 0.5, 0.0); // Bright orange
uniform float edge_width : hint_range(0.0, 1.0) = 0.1; // Width of the edge effect
uniform float intensity : hint_range(1.0, 10.0) = 3.0; // Sharpness of the edge

void fragment() {
    // Calculate the Fresnel effect
    vec3 normal = normalize(NORMAL);
    vec3 view_dir = normalize(-VIEW);
    float fresnel = pow(1.0 - dot(normal, view_dir), intensity);

    // Highlight edges
    float edge = smoothstep(1.0 - edge_width, 1.0, fresnel);

    // Apply the color
    vec3 final_color = mix(ALBEDO.rgb, edge_color, edge);

    ALBEDO = final_color;
}
"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_nvyjx"]
render_priority = 0
shader = SubResource("Shader_1mb4a")
shader_parameter/edge_color = Color(1, 0.5, 0, 1)
shader_parameter/edge_width = 0.1
shader_parameter/intensity = 3.0

[sub_resource type="ArrayMesh" id="ArrayMesh_6k8fn"]

[sub_resource type="BoxShape3D" id="BoxShape3D_w527i"]
size = Vector3(2, 0, 2)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_1myqj"]
render_priority = 0
shader = ExtResource("9_54hal")

[sub_resource type="BoxMesh" id="BoxMesh_141f8"]

[node name="Main" type="Node3D"]

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_chybd")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.866025, -0.433013, 0.25, 0, 0.5, 0.866025, -0.5, 0.75, -0.433013, 0, 0, 0)
shadow_enabled = true

[node name="Ground" type="MeshInstance3D" parent="."]
transform = Transform3D(500, 0, 0, 0, 500, 0, 0, 0, 500, 0, 0, 0)
material_override = SubResource("ShaderMaterial_nvyjx")
material_overlay = ExtResource("2_dqp1b")
mesh = SubResource("ArrayMesh_6k8fn")
script = ExtResource("3_c7yye")

[node name="StaticBody3D" type="StaticBody3D" parent="Ground"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Ground/StaticBody3D"]
shape = SubResource("BoxShape3D_w527i")

[node name="Player_Character" parent="." instance=ExtResource("1_6t2fw")]
script = ExtResource("2_qehyv")

[node name="Manager" type="Node" parent="."]
script = ExtResource("4_gc2hg")

[node name="Ingot" type="Node" parent="Manager"]

[node name="Inventory Manager" type="Control" parent="."]
layout_mode = 3
anchors_preset = 0

[node name="Container" type="Container" parent="Inventory Manager"]
layout_mode = 1
anchors_preset = -1
anchor_right = 0.036
anchor_bottom = 0.063
offset_right = -0.472004
offset_bottom = 0.175999
script = ExtResource("8_k76vs")

[node name="ColorRect" type="ColorRect" parent="Inventory Manager/Container"]
layout_mode = 2
color = Color(0.884703, 0.260816, 0.716615, 1)

[node name="DroppedItem3D" type="Node3D" parent="."]

[node name="MeshInstance3D" type="MeshInstance3D" parent="."]
material_override = SubResource("ShaderMaterial_1myqj")
mesh = SubResource("BoxMesh_141f8")
script = ExtResource("9_ngpnf")
